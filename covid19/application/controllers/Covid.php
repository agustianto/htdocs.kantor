<?php
defined('BASEPATH') OR exit('No direct script access allowed');
class Covid extends CI_Controller {
	function __construct(){
		parent::__construct();
		$this->load->model('Covid_model');
    }
    
    public function index(){
        $data['user'] = $this->Covid_model->getAll()->result();
        $this->load->view('test',$data);
    }

    public function Api(){
        $data = $this->Covid_model->getAll();
        echo json_encode($data->result_array());
    }

    public function history($id)
    {
        $data ['history'] = $this->Covid_model->history($id,'history')->result();
        // var_dump($data);die();
        $this->load->view('history',$data);
    }

    public function input(){
        $id = $this->input->post('id');
        $q1 = $this->input->post('q1');
        $q2 = $this->input->post('q2');
        $q3 = $this->input->post('q3');
        $q4 = $this->input->post('q4');
        $q5 = $this->input->post('q5');
        $q6 = $this->input->post('q6');
        $s = "";
        $status = "";
        $update_at = date('Y-m-d H:i:s');
        $data = array(
            'id' => $id,
            'q1' => $q1,
            'q2' => $q2,
            'q3' => $q3,
            'q4' => $q4,
            'q5' => $q5,
            'q6' => $q6,
            'update_at' => $update_at
        );
        //$question = 0;
        $question = $this->Covid_model->input_data($data,'question');
        // Rule
        if($q1=="1"&&$q2=="1"&&$q3=="1"&&$q4=="1"&&$q5=="1"&&$q6=="1"){ $s = "S1";  $status= "PDP";}
if($q1=="1"&&$q2=="1"&&$q3=="1"&&$q4=="1"&&$q5=="1"&&$q6=="2"){ $s = "S1";  $status= "PDP";}
if($q1=="1"&&$q2=="1"&&$q3=="1"&&$q4=="1"&&$q5=="2"&&$q6=="1"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="1"&&$q3=="1"&&$q4=="1"&&$q5=="2"&&$q6=="2"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="1"&&$q3=="1"&&$q4=="2"&&$q5=="1"&&$q6=="1"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="1"&&$q3=="1"&&$q4=="2"&&$q5=="1"&&$q6=="2"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="1"&&$q3=="1"&&$q4=="2"&&$q5=="2"&&$q6=="1"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="1"&&$q3=="1"&&$q4=="2"&&$q5=="2"&&$q6=="2"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="1"&&$q3=="2"&&$q4=="1"&&$q5=="1"&&$q6=="1"){ $s = "S1";  $status= "PDP";}
if($q1=="1"&&$q2=="1"&&$q3=="2"&&$q4=="1"&&$q5=="1"&&$q6=="2"){ $s = "S1";  $status= "PDP";}
if($q1=="1"&&$q2=="1"&&$q3=="2"&&$q4=="1"&&$q5=="2"&&$q6=="1"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="1"&&$q3=="2"&&$q4=="1"&&$q5=="2"&&$q6=="2"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="1"&&$q3=="2"&&$q4=="2"&&$q5=="1"&&$q6=="1"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="1"&&$q3=="2"&&$q4=="2"&&$q5=="1"&&$q6=="2"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="1"&&$q3=="2"&&$q4=="2"&&$q5=="2"&&$q6=="1"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="1"&&$q3=="2"&&$q4=="2"&&$q5=="2"&&$q6=="2"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="2"&&$q3=="1"&&$q4=="1"&&$q5=="1"&&$q6=="1"){ $s = "S1";  $status= "PDP";}
if($q1=="1"&&$q2=="2"&&$q3=="1"&&$q4=="1"&&$q5=="1"&&$q6=="2"){ $s = "S1";  $status= "PDP";}
if($q1=="1"&&$q2=="2"&&$q3=="1"&&$q4=="1"&&$q5=="2"&&$q6=="1"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="2"&&$q3=="1"&&$q4=="1"&&$q5=="2"&&$q6=="2"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="2"&&$q3=="1"&&$q4=="2"&&$q5=="1"&&$q6=="1"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="2"&&$q3=="1"&&$q4=="2"&&$q5=="1"&&$q6=="2"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="2"&&$q3=="1"&&$q4=="2"&&$q5=="2"&&$q6=="1"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="2"&&$q3=="1"&&$q4=="2"&&$q5=="2"&&$q6=="2"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="2"&&$q3=="2"&&$q4=="1"&&$q5=="1"&&$q6=="1"){ $s = "S1";  $status= "PDP";}
if($q1=="1"&&$q2=="2"&&$q3=="2"&&$q4=="1"&&$q5=="1"&&$q6=="2"){ $s = "S1";  $status= "PDP";}
if($q1=="1"&&$q2=="2"&&$q3=="2"&&$q4=="1"&&$q5=="2"&&$q6=="1"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="2"&&$q3=="2"&&$q4=="1"&&$q5=="2"&&$q6=="2"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="2"&&$q3=="2"&&$q4=="2"&&$q5=="1"&&$q6=="1"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="2"&&$q3=="2"&&$q4=="2"&&$q5=="1"&&$q6=="2"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="2"&&$q3=="2"&&$q4=="2"&&$q5=="2"&&$q6=="1"){ $s = "S2";  $status= "ODP";}
if($q1=="1"&&$q2=="2"&&$q3=="2"&&$q4=="2"&&$q5=="2"&&$q6=="2"){ $s = "S2";  $status= "OTG";}
if($q1=="2"&&$q2=="1"&&$q3=="1"&&$q4=="1"&&$q5=="1"&&$q6=="1"){ $s = "S1";  $status= "PDP";}
if($q1=="2"&&$q2=="1"&&$q3=="1"&&$q4=="1"&&$q5=="1"&&$q6=="2"){ $s = "S1";  $status= "PDP";}
if($q1=="2"&&$q2=="1"&&$q3=="1"&&$q4=="1"&&$q5=="2"&&$q6=="1"){ $s = "S2";  $status= "ODP";}
if($q1=="2"&&$q2=="1"&&$q3=="1"&&$q4=="1"&&$q5=="2"&&$q6=="2"){ $s = "S2";  $status= "ODP";}
if($q1=="2"&&$q2=="1"&&$q3=="1"&&$q4=="2"&&$q5=="1"&&$q6=="1"){ $s = "S2";  $status= "ODP";}
if($q1=="2"&&$q2=="1"&&$q3=="1"&&$q4=="2"&&$q5=="1"&&$q6=="2"){ $s = "S2";  $status= "ODP";}
if($q1=="2"&&$q2=="1"&&$q3=="1"&&$q4=="2"&&$q5=="2"&&$q6=="1"){ $s = "S2";  $status= "ODP";}
if($q1=="2"&&$q2=="1"&&$q3=="1"&&$q4=="2"&&$q5=="2"&&$q6=="2"){ $s = "S2";  $status= "ODP";}
if($q1=="2"&&$q2=="1"&&$q3=="2"&&$q4=="1"&&$q5=="1"&&$q6=="1"){ $s = "S1";  $status= "PDP";}
if($q1=="2"&&$q2=="1"&&$q3=="2"&&$q4=="1"&&$q5=="1"&&$q6=="2"){ $s = "S1";  $status= "PDP";}
if($q1=="2"&&$q2=="1"&&$q3=="2"&&$q4=="1"&&$q5=="2"&&$q6=="1"){ $s = "S2";  $status= "ODP";}
if($q1=="2"&&$q2=="1"&&$q3=="2"&&$q4=="1"&&$q5=="2"&&$q6=="2"){ $s = "S2";  $status= "ODP";}
if($q1=="2"&&$q2=="1"&&$q3=="2"&&$q4=="2"&&$q5=="1"&&$q6=="1"){ $s = "S2";  $status= "ODP";}
if($q1=="2"&&$q2=="1"&&$q3=="2"&&$q4=="2"&&$q5=="1"&&$q6=="2"){ $s = "S2";  $status= "ODP";}
if($q1=="2"&&$q2=="1"&&$q3=="2"&&$q4=="2"&&$q5=="2"&&$q6=="1"){ $s = "S2";  $status= "ODP";}
if($q1=="2"&&$q2=="1"&&$q3=="2"&&$q4=="2"&&$q5=="2"&&$q6=="2"){ $s = "S2";  $status= "ODP";}
if($q1=="2"&&$q2=="2"&&$q3=="1"&&$q4=="1"&&$q5=="1"&&$q6=="1"){ $s = "S1";  $status= "PDP";}
if($q1=="2"&&$q2=="2"&&$q3=="1"&&$q4=="1"&&$q5=="1"&&$q6=="2"){ $s = "S1";  $status= "PDP";}
if($q1=="2"&&$q2=="2"&&$q3=="1"&&$q4=="1"&&$q5=="2"&&$q6=="1"){ $s = "S2";  $status= "ODP";}
if($q1=="2"&&$q2=="2"&&$q3=="1"&&$q4=="1"&&$q5=="2"&&$q6=="2"){ $s = "S2";  $status= "ODP";}
if($q1=="2"&&$q2=="2"&&$q3=="1"&&$q4=="2"&&$q5=="1"&&$q6=="1"){ $s = "S2";  $status= "ODP";}
if($q1=="2"&&$q2=="2"&&$q3=="1"&&$q4=="2"&&$q5=="1"&&$q6=="2"){ $s = "S2";  $status= "ODP";}
if($q1=="2"&&$q2=="2"&&$q3=="1"&&$q4=="2"&&$q5=="2"&&$q6=="1"){ $s = "S2";  $status= "ODP";}
if($q1=="2"&&$q2=="2"&&$q3=="1"&&$q4=="2"&&$q5=="2"&&$q6=="2"){ $s = "S2";  $status= "ODP";}
if($q1=="2"&&$q2=="2"&&$q3=="2"&&$q4=="1"&&$q5=="1"&&$q6=="1"){ $s = "S1";  $status= "PDP";}
if(($q1=="2")&&($q2=="2")&&($q3=="2")&&($q4=="1")&&($q5=="1")&&($q6=="2")){ $s = "S1";  $status= "PDP";}
if(($q1=="2")&&($q2=="2")&&($q3=="2")&&($q4=="1")&&($q5=="2")&&($q6=="1")){ $s = "S2";  $status= "ODP";}
if(($q1=="2")&&($q2=="2")&&($q3=="2")&&($q4=="1")&&($q5=="2")&&($q6=="2")){ $s = "S2";  $status= "ODP";}
if(($q1=="2")&&($q2=="2")&&($q3=="2")&&($q4=="2")&&($q5=="1")&&($q6=="1")){ $s = "S2";  $status= "ODP";}
if(($q1=="2")&&($q2=="2")&&($q3=="2")&&($q4=="2")&&($q5=="1")&&($q6=="2")){ $s = "S2";  $status= "ODP";}
if(($q1=="2")&&($q2=="2")&&($q3=="2")&&($q4=="2")&&($q5=="2")&&($q6=="1")){ $s = "S2";  $status= "ODP";}
if(($q1=="2")&&($q2=="2")&&($q3=="2")&&($q4=="2")&&($q5=="2")&&($q6=="2")){ $s = "S2";  $status= "OTG";}
if(($q1=="3")&&($q2=="1")&&($q3=="1")&&($q4=="1")&&($q5=="1")&&($q6=="1")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="1")&&($q3=="1")&&($q4=="1")&&($q5=="1")&&($q6=="2")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="1")&&($q3=="1")&&($q4=="1")&&($q5=="2")&&($q6=="1")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="1")&&($q3=="1")&&($q4=="1")&&($q5=="2")&&($q6=="2")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="1")&&($q3=="1")&&($q4=="2")&&($q5=="1")&&($q6=="1")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="1")&&($q3=="1")&&($q4=="2")&&($q5=="1")&&($q6=="2")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="1")&&($q3=="1")&&($q4=="2")&&($q5=="2")&&($q6=="1")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="1")&&($q3=="1")&&($q4=="2")&&($q5=="2")&&($q6=="2")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="1")&&($q3=="2")&&($q4=="1")&&($q5=="1")&&($q6=="1")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="1")&&($q3=="2")&&($q4=="1")&&($q5=="1")&&($q6=="2")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="1")&&($q3=="2")&&($q4=="1")&&($q5=="2")&&($q6=="1")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="1")&&($q3=="2")&&($q4=="1")&&($q5=="2")&&($q6=="2")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="1")&&($q3=="2")&&($q4=="2")&&($q5=="1")&&($q6=="1")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="1")&&($q3=="2")&&($q4=="2")&&($q5=="1")&&($q6=="2")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="1")&&($q3=="2")&&($q4=="2")&&($q5=="2")&&($q6=="1")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="1")&&($q3=="2")&&($q4=="2")&&($q5=="2")&&($q6=="2")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="2")&&($q3=="1")&&($q4=="1")&&($q5=="1")&&($q6=="1")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="2")&&($q3=="1")&&($q4=="1")&&($q5=="1")&&($q6=="2")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="2")&&($q3=="1")&&($q4=="1")&&($q5=="2")&&($q6=="1")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="2")&&($q3=="1")&&($q4=="1")&&($q5=="2")&&($q6=="2")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="2")&&($q3=="1")&&($q4=="2")&&($q5=="1")&&($q6=="1")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="2")&&($q3=="1")&&($q4=="2")&&($q5=="1")&&($q6=="2")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="2")&&($q3=="1")&&($q4=="2")&&($q5=="2")&&($q6=="1")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="2")&&($q3=="1")&&($q4=="2")&&($q5=="2")&&($q6=="2")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="2")&&($q3=="2")&&($q4=="1")&&($q5=="1")&&($q6=="1")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="2")&&($q3=="2")&&($q4=="1")&&($q5=="1")&&($q6=="2")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="2")&&($q3=="2")&&($q4=="1")&&($q5=="2")&&($q6=="1")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="2")&&($q3=="2")&&($q4=="1")&&($q5=="2")&&($q6=="2")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="2")&&($q3=="2")&&($q4=="2")&&($q5=="1")&&($q6=="1")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="2")&&($q3=="2")&&($q4=="2")&&($q5=="1")&&($q6=="2")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="2")&&($q3=="2")&&($q4=="2")&&($q5=="2")&&($q6=="1")){ $s = "S2";  $status= "ODP";}
if(($q1=="3")&&($q2=="2")&&($q3=="2")&&($q4=="2")&&($q5=="2")&&($q6=="2")){ $s = "S3";  $status= "Sehat";}
// else{
//            $s = "S2";  $status= "ODP"; 
//         }

        $data = array(
            'id' => $id,
            'status' => $status,
            'update_at' => $update_at
        );
    
        $where = array(
            'id' => $id
        );
    
        $get = $this->Covid_model->get($data['id'],'data');

        if (empty($get)) {
            $this->Covid_model->input_data($data,'data');
        }
        else{

        $this->Covid_model->update_data($where,$data,'data');
        }
        // var_dump($question);die();
        $history = array(
            'id' => $id,
            'kode_question' => $question,
            'status' => $status,
            'update_at' => $update_at
        );

        // echo $history['kode_question']; die();
        $this->Covid_model->input_data($history,'history');
        $data['s'] = $s;
        $data['id'] = $id;
        // die();
        $this->load->view('result',$data);
    }
}
